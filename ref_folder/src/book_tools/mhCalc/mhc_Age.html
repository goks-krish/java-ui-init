<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=100%; initial-scale=1.0;">

<title>Age Calculators</title>

<style type="text/css">
    body, html {
        font-family: Arial, Verdana, Monaco, sans-serif;
        font-size: 0.9em;
        background-color: #e9e9ff;
    }
</style>
</head>
<body>
<script language="JavaScript">
function ResetForm(obj) {
  // Get the Date and set default
  var the_date  = new Date();
  var the_month = the_date.getMonth() + 1;
  var the_day   = the_date.getDate();
  var the_year  = the_date.getFullYear();
  var ToDate    = the_month + "/" + the_day + "/" + the_year;

  obj.DoB.value = "";
  obj.DoC.value = ToDate;
  obj.AgeYears.value = " ";
  obj.AgeRmdr.value = " ";
  obj.AgeMonth.value = " ";
  obj.AgeWeeks.value = " ";
  obj.AgeDays.value = " ";
}

function CalcAge(obj) {
  var DoB    = Date.parse(obj.DoB.value);
  var DoC    = Date.parse(obj.DoC.value);
  var AOkay  = true;

  // Check dates for validity
  if ((DoB==null)||(isNaN(DoB))) {
    alert("Date of Birth is invalid.");
    AOkay = false;
  }
  if ((DoC==null)||(isNaN(DoC))) {
    alert("Specified Date is invalid.");
    AOkay = false;
  }

  var ToDate   = new Date();
  var ToDateYr = ToDate.getFullYear();
  var DateofB  = new Date(DoB);
  var DoBYr    = DateofB.getFullYear();
  var DoBMo    = DateofB.getMonth();
  var DoBDy    = DateofB.getDate();

  obj.DoB.value = (DoBMo+1) +"/"+ DoBDy +"/"+ DoBYr;

  var DateofC  = new Date(DoC);
  var DoCYr    = DateofC.getFullYear();
  var DoCMo    = DateofC.getMonth();
  var DoCDy    = DateofC.getDate();

  obj.DoC.value = " "+ (DoCMo+1) +"/"+ DoCDy +"/"+ DoCYr;

  if (DoB > DoC) {
    alert("The Date of Birth is after the specified date.");
    AOkay = false;
  }

  if (DoC > ToDate) {
    alert("The specified date is in the future.\n           Continuing calculation.");
  }

  if (AOkay) {
    var AgeDays  = 0;
    var AgeWeeks = 0;
    var AgeMonth = 0;
    var AgeYears = 0;
    var AgeRmdr  = 0;

    mSecDiff   = DoC - DoB;
    AgeDays  = mSecDiff / 86400000;
    AgeWeeks = AgeDays / 7;
    AgeMonth = AgeDays / 30.4375;
    AgeYears = AgeDays / 365.24;    
    AgeYears = Math.floor(AgeYears);
    AgeRmdr  = (AgeDays - AgeYears * 365.24) / 30.4375;

    AgeDays  = Math.round(AgeDays * 10) / 10;
    AgeWeeks = Math.round(AgeWeeks * 10) / 10;
    AgeMonth = Math.round(AgeMonth * 10) / 10;
    AgeRmdr  = Math.round(AgeRmdr * 10) / 10;

    obj.AgeDays.value = AgeDays;
    obj.AgeWeeks.value = AgeWeeks;
    obj.AgeMonth.value = AgeMonth;
    obj.AgeYears.value = AgeYears;
    obj.AgeRmdr.value = AgeRmdr;
  }
}

</script>

  <div id="bodyMaster"> 
    <div id="bodySub"> <!-- Begin Left Column --> 
      <div id="leftCol"> 
      </div>
      <!-- End Left Column --> 
      <!-- Begin Middle Column --> 
      <div id="centerCol"> 
      <!-- activate for 4th level nav -->

     
        <h1><!-- #BeginEditable "Title" -->Age 
                  Calculator<!-- #EndEditable --></h1>
        <!-- #BeginEditable "Body" --> 
        <p>Calculate the age based on the Date of Birth and another date (default 
          is the current date).</p>
        <form action="" name="Age">
          <table border="0" cellpadding="0" align="center">
            <tr> 
              <td>Date of Birth</td>
              <td></td>
              <td> 
                <input type="text" name="DoB" size="10">
              </td>
            </tr>
            <tr> 
              <td>Age at This Date</td>
              <td></td>
              <td> 
                <input type="text" name="DoC" size="10">
              </td>
            </tr>
            <tr> 
              <td colspan="3"> 
                <div align="center"> 
                  <input type="button" name="CalculateAge" value="Calculate" onClick="CalcAge(this.form)">
                  <input type="button" name="ClearSome" value="Clear" onClick="ResetForm(this.form)">
                </div>
              </td>
            </tr>
            <tr> 
              <td> 
                <div align="right">Age&nbsp;</div>
              </td>
              <td> =&nbsp;</td>
              <td> 
                <input type="text" name="AgeYears" size="6">
                years 
                <input type="text" name="AgeRmdr" size="5">
                months</td>
            </tr>
            <tr> 
              <td></td>
              <td>=&nbsp;</td>
              <td> 
                <input type="text" name="AgeMonth" size="6">
                months</td>
            </tr>
            <tr> 
              <td></td>
              <td>=&nbsp;</td>
              <td> 
                <input type="text" name="AgeWeeks" size="6">
                weeks</td>
            </tr>
            <tr> 
              <td></td>
              <td>=&nbsp;</td>
              <td> 
                <input type="text" name="AgeDays" size="6">
                days</td>
            </tr>
          </table>
<script language="JavaScript">
// Get the Date and set default
var the_date  = new Date();
var the_month = the_date.getMonth() + 1;
var the_day   = the_date.getDate();
var the_year  = the_date.getFullYear();
var ToDate    = the_month + "/" + the_day + "/" + the_year;

window.document.Age.DoC.value = ToDate;
</script>
        </form>
        <p>&nbsp;</p>
        <p align="center"><img src="./images/drop_shadow.gif" width="300" height="4"></p>
        <p>Dates should be entered in the US format <i>mm/dd/yyyy</i>, using four 
          digits for the year.</p>
        <p>&nbsp;</p>
      </div>
      <div id="rightCol"> 
      </div>
    </div>
  </div>
</body>
</html>

